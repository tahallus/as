#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если НЕ ЗначениеЗаполнено(Параметры.Касса) Тогда
		Отказ = Истина;
		Возврат;
	КонецЕсли;
	
	ИнформацияОКассе = Новый Структура(
		"РегистрационныйНомер", 
		ИнтеграцияОбменШтрихМ.ПолучитьРеквизитыКассыШтрихМ(Параметры.Касса).РегистрационныйНомер);
	
	ЗарегистрированнаяКасса = ОбменСКассовымСерверомШтрихМ.ЗарегистрированнаяКассаНаСервере(ИнформацияОКассе, Ложь, "");
	
	ПротоколОбмена.УстановитьТекст(
		ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ЗарегистрированнаяКасса, "СообщениеПриРегистрации"));
	
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(ДанныеОбмена.Отбор,"КассаККМ",Параметры.Касса);
	
КонецПроцедуры

#КонецОбласти
