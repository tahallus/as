#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Установка значения Спам = Ложь для документа Событие
//
// Параметры:
//  Событие - ДокументСсылка.Событие - Ссылка на документ "Событие"
Процедура УбратьИзСпама(Событие) Экспорт
	
	Если Не ЗначениеЗаполнено(Событие) Тогда
		Возврат;
	КонецЕсли;
	
	Если Не ПравоДоступа("Изменение", Метаданные.РегистрыСведений.СпамСобытий) Тогда
		Возврат;
	КонецЕсли;
	
	МенеджерЗаписи = СоздатьМенеджерЗаписи();
	МенеджерЗаписи.Событие = Событие;
	МенеджерЗаписи.Удалить();
	
	ЭлектроннаяПочтаУНФ.УбратьИзСпама(Событие.УчетнаяЗапись, Событие);
	
КонецПроцедуры

// Установка значения Спам = Истина для документа Событие
//
// Параметры:
//  Событие - ДокументСсылка.Событие - Ссылка на документ "Событие"
Процедура ПометитьКакСпам(Событие) Экспорт
	
	Если Не ЗначениеЗаполнено(Событие) Тогда
		Возврат;
	КонецЕсли;
	
	Если Не ПравоДоступа("Изменение", Метаданные.РегистрыСведений.СпамСобытий) Тогда
		Возврат;
	КонецЕсли;
	
	МенеджерЗаписи = СоздатьМенеджерЗаписи();
	МенеджерЗаписи.Событие = Событие;
	МенеджерЗаписи.Спам = Истина;
	МенеджерЗаписи.Записать();
	
	ЭлектроннаяПочтаУНФ.ПометитьКакСпам(Событие.УчетнаяЗапись, Событие);
	
КонецПроцедуры

// Удаление записи о Спаме, для документа Событие
//
// Параметры:
//  Событие - ДокументСсылка.Событие - Ссылка на документ "Событие"
Процедура УдалитьЗапись(Событие) Экспорт
	
	Если Не ЗначениеЗаполнено(Событие) Тогда
		Возврат;
	КонецЕсли;
	
	Если Не ПравоДоступа("Изменение", Метаданные.РегистрыСведений.СпамСобытий) Тогда
		Возврат;
	КонецЕсли;
	
	МенеджерЗаписи = СоздатьМенеджерЗаписи();
	МенеджерЗаписи.Событие = Событие;
	МенеджерЗаписи.Удалить();
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли