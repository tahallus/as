#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	КонтекстОткрытия = КонтекстОткрытияПрайсЛиста();
	
	ИмяОткрываемойФормы = "Справочник.ПрайсЛисты.ФормаСписка";
	Если КонтекстОткрытия.ЕстьПравоДобавленияНового
		И (КонтекстОткрытия.КоличествоПрайсЛистов < 2
			ИЛИ КонтекстОткрытия.ОткрыватьПрайсЛистОрганизацииКакСписок = Ложь) Тогда
		
		ИмяОткрываемойФормы = "Обработка.ПрайсЛистыОрганизации.Форма";
		
	КонецЕсли;
	
	ОткрытьФорму(ИмяОткрываемойФормы);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция КонтекстОткрытияПрайсЛиста()
	
	КонтекстОткрытия = Новый Структура;
	КонтекстОткрытия.Вставить("КоличествоПрайсЛистов", Справочники.ПрайсЛисты.КоличествоПрайсЛистовПользователя());
	КонтекстОткрытия.Вставить("ОткрыватьПрайсЛистОрганизацииКакСписок",
		УправлениеНебольшойФирмойПовтИсп.ПолучитьЗначениеНастройки("ОткрыватьПрайсЛистОрганизацииКакСписок"));
	КонтекстОткрытия.Вставить("ЕстьПравоДобавленияНового", ПравоДоступа("Добавление",
		Метаданные.Справочники.ПрайсЛисты));
	
	Возврат КонтекстОткрытия;
	
КонецФункции

#КонецОбласти
