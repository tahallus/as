
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	СоздатьНастройкиВХранилище();
	
	НастройкиПоНоменклатуре = Константы.НастройкиКонтроляДублейНоменклатура.Получить().Получить();
	
	// Контроль по наименованию
	НовоеСоответствие = НастройкиКонтроля.Добавить();
	НовоеСоответствие.РеквизитНоменклатуры = "Наименование";
	НовоеСоответствие.ПроверятьРеквизитНоменклатуры = НастройкиПоНоменклатуре.Получить("ПроверятьНаименование");
	
	// Контроль по полному наименованию
	НовоеСоответствие = НастройкиКонтроля.Добавить();
	НовоеСоответствие.РеквизитНоменклатуры = "Наименование для печати";
	НовоеСоответствие.ПроверятьРеквизитНоменклатуры = НастройкиПоНоменклатуре.Получить("ПроверятьНаименованиеПолное");
	
	// Контроль по артикулу
	НовоеСоответствие = НастройкиКонтроля.Добавить();
	НовоеСоответствие.РеквизитНоменклатуры = "Артикул";
	НовоеСоответствие.ПроверятьРеквизитНоменклатуры = НастройкиПоНоменклатуре.Получить("ПроверятьАртикул");
	
КонецПроцедуры

&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)
	УстановитьНастройкиКонтроля();
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УстановитьНастройкиКонтроля()
	
	Результат = Новый Соответствие;
	Результат.Вставить("ПроверятьНаименование", НастройкиКонтроля[0].ПроверятьРеквизитНоменклатуры);
	Результат.Вставить("ПроверятьНаименованиеПолное",      НастройкиКонтроля[1].ПроверятьРеквизитНоменклатуры);
	Результат.Вставить("ПроверятьАртикул",      НастройкиКонтроля[2].ПроверятьРеквизитНоменклатуры);
	
	Константы.НастройкиКонтроляДублейНоменклатура.Установить(Новый ХранилищеЗначения(Результат, Новый СжатиеДанных(6)));
	
КонецПроцедуры

&НаСервере
Процедура СоздатьНастройкиВХранилище()
	
	НастройкиПоНоменклатуре = Константы.НастройкиКонтроляДублейНоменклатура.Получить().Получить();
	Если НастройкиПоНоменклатуре = Неопределено Тогда
		Результат = Новый Соответствие;
		Результат.Вставить("ПроверятьНаименование", Ложь);
		Результат.Вставить("ПроверятьНаименованиеПолное", Ложь);
		Результат.Вставить("ПроверятьАртикул",      Ложь);
		
		Константы.НастройкиКонтроляДублейНоменклатура.Установить(Новый ХранилищеЗначения(Результат, Новый СжатиеДанных(6)));
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
