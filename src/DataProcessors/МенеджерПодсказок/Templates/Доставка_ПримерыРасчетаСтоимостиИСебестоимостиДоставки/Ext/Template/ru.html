<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="__STYLE__"></link><meta name="GENERATOR" content="MSHTML 11.00.9600.18538"></meta></head><body>
<p><strong>Пример 1</strong>. Имеется следующее правило: «Регион: Москва или Санкт-Петербург: Первый кг – 210р., каждый последующий полный/неполный кг – 95р.. Регион: Вся Россия: Первый кг – 315р., каждый последующий полный/неполный кг – 95р.». Для разделения заказов по регионам используется реквизит "Зона / тариф". В таком случае формулы расчета стоимости доставки будут такими:</p>
<p></p>
<table width="100%"><tbody><tr><td><strong>Условие</strong></td>
<td><strong>Значение</strong></td>
<td><strong>Формула</strong></td></tr><tr><td>Заказ.ЗонаТариф</td>
<td>Москва или Санкт-Петербург</td>
<td>115 + 95 * Окр([Заказ.Вес]+0.5, 0, РежимОкругления.Окр15Как10)</td></tr><tr><td>Заказ.ЗонаТариф</td>
<td>Вся Россия</td>
<td>220 + 95 * Окр([Заказ.Вес]+0.5, 0, РежимОкругления.Окр15Как10)</td></tr></tbody></table><p><strong>Пример 2</strong>. Для доставки заказов внутри МКАД стоимость доставки  составляет 230р. При сумме заказа свыше 2000р. - бесплатно. При доставке за МКАД заказов весом до 5 кг на расстояние до 20 км стоимость доставки составит 380р., до 50 км - 560р., свыше 50 км - 710р. За каждый последующий килограмм доплата 20р. Для автоматизации расчета такого правила в форме редактирования формулы следует добавить параметр расчета "Расстояние за МКАД" с отметкой "Задавать значение при расчете". Значение такого параметра можно будет указать для каждого заказа на закладке "Доставка". Формула расчета стоимости в данном случае будет такой:</p>
<p></p>
<table width="100%"><tbody><tr><td><strong>Условие</strong></td>
<td><strong>Значение</strong></td>
<td><strong>Формула</strong></td></tr><tr><td>РасстояниеЗаМКАД</td>
<td>0</td>
<td>?( [Заказ.СуммаДокумента] &gt;= 2000, 0, 230)</td></tr><tr><td>РасстояниеЗаМКАД</td>
<td>Меньше 20</td>
<td>380 + 20 * (Окр(Макс([Заказ.Вес], 5) + 0.5, 0, РежимОкругления.Окр15Как10) - 5)</td></tr><tr><td>РасстояниеЗаМКАД</td>
<td>Меньше 50</td>
<td>560 + 20 * (Окр(Макс([Заказ.Вес], 5) + 0.5, 0, РежимОкругления.Окр15Как10) - 5)</td></tr><tr><td>РасстояниеЗаМКАД</td>
<td>Больше или равно 50</td>
<td>710 + 20 * (Окр(Макс([Заказ.Вес], 5) + 0.5, 0, РежимОкругления.Окр15Как10) - 5)</td></tr></tbody></table></body></html>