
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	// Пропускаем инициализацию, чтобы гарантировать получение формы при передаче параметра "АвтоТест".
	Если Параметры.Свойство("АвтоТест") Тогда
		Возврат;
	КонецЕсли;
	
	Заголовок = Параметры.Заголовок;
	
	ИзмененныеРеквизиты = Параметры.ИзмененныеРеквизиты;
	ИнициализироватьТаблицуСравнения(ИзмененныеРеквизиты);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормы

#КонецОбласти

#Область ОбработчикиКомандФормы


#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура ИнициализироватьТаблицуСравнения(ИзмененныеРеквизиты)
	
	ТаблицаСравнения = РеквизитФормыВЗначение("ТаблицаСравненияРеквизитов");
	
	Для каждого ИзмененныйРеквизит Из ИзмененныеРеквизиты Цикл
		
		НоваяСтрока = ТаблицаСравнения.Добавить();
		НоваяСтрока.Представление = ИзмененныйРеквизит.Представление;
		НоваяСтрока.Было  = ПреобразоватьЗначение(ИзмененныйРеквизит.Было);
		НоваяСтрока.Стало = ПреобразоватьЗначение(ИзмененныйРеквизит.Стало);
		
	КонецЦикла; 

	ЗначениеВРеквизитФормы(ТаблицаСравнения, "ТаблицаСравненияРеквизитов");
	
КонецПроцедуры

&НаСервере
Функция ПреобразоватьЗначение(Значение)
	
	Если НЕ ЗначениеЗаполнено(Значение) Тогда
		Возврат "";
	КонецЕсли;
	
	Если ТипЗнч(Значение) = Тип("Дата") Тогда
		Возврат Формат(Значение, "ДФ=dd.MM.yyyy; ДП=");
	Иначе
		Возврат Значение;
	КонецЕсли;
	
КонецФункции

#КонецОбласти


