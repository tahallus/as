
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство("НачальнаяСтраница") Тогда
		Элементы.ЗакрытьФорму.Видимость = Не Параметры.НачальнаяСтраница;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	// ПодключаемоеОборудование
	Если Источник = "ПодключаемоеОборудование" И ВводДоступен() Тогда
		Если ИмяСобытия = "ScanData" Тогда
			// Преобразуем предварительно к ожидаемому формату
			Данные = Новый Массив();
			Если Параметр[1] = Неопределено Тогда
				Штрихкод = Параметр[0];
			Иначе
				Штрихкод = Параметр[1][1]; // Достаем штрихкод из дополнительных данных
			КонецЕсли;
			
			Ответственный = Сотрудники.СотрудникПоШтрихКоду(Штрихкод);
			
			Если Не ЗначениеЗаполнено(Ответственный) Тогда
				
				Сообщение = Новый СообщениеПользователю;
				Сообщение.Текст = НСтр("ru = 'Не найден ответственный сотрудник по штрихкоду. Выберите ответственного вручную.'");
				Сообщение.Поле = "Элементы.Сотрудник";
				Сообщение.УстановитьДанные(ЭтотОбъект);
				Сообщение.Сообщить()
				
			Иначе
				
				СтруктураЗакрытия = Новый Структура("Ответственный", Ответственный);
				ЭтаФорма.Закрыть(СтруктураЗакрытия);
				
			КонецЕсли;
			
		КонецЕсли;
	КонецЕсли;
	// Конец ПодключаемоеОборудование
	
	Если ИмяСобытия = "РМКОткрыт" Тогда
		ЭтаФорма.Активизировать();
	КонецЕсли;
	
	//Если ИмяСобытия = "РМКЗакрыт" Тогда
	//	ЭтаФорма.Закрыть();
	//КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура СотрудникОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	Если Не ЗначениеЗаполнено(ВыбранноеЗначение) Тогда
		Возврат
	Иначе
		Ответственный = ВыбранноеЗначение;
	КонецЕсли;
	
	СтруктураЗакрытия = Новый Структура("Ответственный", Ответственный);
	
	ЭтаФорма.Закрыть(СтруктураЗакрытия);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура Выбрать(Команда)
	
	Если Не ЗначениеЗаполнено(Ответственный) Тогда
		Возврат
	КонецЕсли;
	
	СтруктураЗакрытия = Новый Структура("Ответственный", Ответственный);
	
	ЭтаФорма.Закрыть(СтруктураЗакрытия);
	
КонецПроцедуры

&НаКлиенте
Процедура ЗакрытьФорму(Команда)
	
	СтруктураЗакрытия = Новый Структура("Ответственный", Неопределено);
	ЭтаФорма.Закрыть(СтруктураЗакрытия);
	
КонецПроцедуры

#КонецОбласти
