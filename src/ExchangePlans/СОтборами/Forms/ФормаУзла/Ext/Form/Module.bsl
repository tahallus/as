#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

	ОбменДаннымиУНФ.ПриСозданииНаСервереФормыУзла(ЭтотОбъект, Элементы);
	ОбменДаннымиУНФ.ОбновитьЗаголовкиКомандФормы(Объект, Элементы);

	ЗапретРедактированияРеквизитовОбъектов.ЗаблокироватьРеквизиты(ЭтотОбъект);

КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)

	ОбменДаннымиУНФКлиент.ОбновитьСвойстваЭлементовФормы(ЭтотОбъект, Объект, Элементы);

КонецПроцедуры

&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)

	ОбменДаннымиКлиент.ФормаНастройкиПередЗакрытием(Отказ, ЭтотОбъект, ЗавершениеРаботы);

КонецПроцедуры

&НаКлиенте
Процедура ОбработкаВыбора(ВыбранноеЗначение, ИсточникВыбора)

	ОбновитьДанныеОбъекта(ВыбранноеЗначение);
	Модифицированность = Истина;

КонецПроцедуры

&НаСервере
Процедура ПриЗаписиНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)

	ОбменДаннымиСервер.ФормаУзлаПриЗаписиНаСервере(ТекущийОбъект, Отказ);

КонецПроцедуры

&НаКлиенте
Процедура ПослеЗаписи(ПараметрыЗаписи)

	Оповестить("Запись_УзелПланаОбмена");

КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура ИспользоватьОтборПоОрганизациямПриИзменении(Элемент)

	ОбменДаннымиУНФКлиент.ОбновитьСвойстваЭлементовФормы(ЭтотОбъект, Объект, Элементы);

КонецПроцедуры

&НаКлиенте
Процедура ВыбратьОрганизацииНажатие(Элемент)

	ПараметрыФормы = ОбменДаннымиУНФКлиентСервер.НовыеПараметрыФормыВыбораДополнительныхУсловий();
	ПараметрыФормы.ТаблицаВыбора = "Справочник.Организации";
	ПараметрыФормы.ТаблицаЗаполнения = "Организации";
	ПараметрыФормы.КолонкаЗаполнения = "Организация";
	ПараметрыФормы.ЗаголовокФормыВыбора = НСтр("ru = 'Организации'");
	ПараметрыФормы.АдресВыбранныхЗначений = АдресВыбранныхЗначений(ПараметрыФормы);

	ОткрытьФорму("ОбщаяФорма.НастройкаОтборовУзлаРИБ", ПараметрыФормы, ЭтотОбъект);

КонецПроцедуры

&НаКлиенте
Процедура ВыбратьОрганизацииРасширеннаяПодсказкаОбработкаНавигационнойСсылки(Элемент,
	НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка)

	СтандартнаяОбработка = Ложь;
	ПараметрыФормы = Новый Структура("СтрокаПоиска", НСтр("ru = 'Несколько организаций'"));
	ОткрытьФорму("Обработка.НастройкаПрограммы.Форма", ПараметрыФормы, ЭтотОбъект);

КонецПроцедуры

&НаКлиенте
Процедура ИспользоватьОтборПоСкладамПриИзменении(Элемент)

	ОбменДаннымиУНФКлиент.ОбновитьСвойстваЭлементовФормы(ЭтотОбъект, Объект, Элементы);

КонецПроцедуры

&НаКлиенте
Процедура ВыбратьСкладыИМагазиныНажатие(Элемент)

	ПараметрыФормы = ОбменДаннымиУНФКлиентСервер.НовыеПараметрыФормыВыбораДополнительныхУсловий();
	ПараметрыФормы.ТаблицаВыбора = "Справочник.СтруктурныеЕдиницы";
	ПараметрыФормы.ТаблицаЗаполнения = "СкладыИМагазины";
	ПараметрыФормы.КолонкаЗаполнения = "СтруктурнаяЕдиница";
	ПараметрыФормы.ЗаголовокФормыВыбора = НСтр("ru = 'Склады и магазины'");
	ПараметрыФормы.АдресВыбранныхЗначений = АдресВыбранныхЗначений(ПараметрыФормы);
	ПараметрыФормы.УпорядочитьПоВозрастаниюИерархии = Истина;

	Фильтр = ОбменДаннымиУНФКлиентСервер.НовыйФильтрФормыВыбораДополнительныхУсловий();
	Фильтр.ИмяПараметра = "ТипСтруктурнойЕдиницы";
	Фильтр.ИмяПоля = "ТипСтруктурнойЕдиницы";
	Для Каждого ТипСтруктурнойЕдиницы Из ОбменДаннымиУНФКлиентСервер.ТипыСтруктурныхЕдиницСкладыИМагазины() Цикл
		Фильтр.ЗначениеПараметра.Добавить(ТипСтруктурнойЕдиницы);
	КонецЦикла;
	ПараметрыФормы.Фильтры.Добавить(Фильтр);

	ОткрытьФорму("ОбщаяФорма.НастройкаОтборовУзлаРИБ", ПараметрыФормы, ЭтотОбъект);

КонецПроцедуры

&НаКлиенте
Процедура ВыбратьСкладыИМагазиныРасширеннаяПодсказкаОбработкаНавигационнойСсылки(Элемент,
	НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка)

	ОбменДаннымиУНФКлиент.ВыбратьСкладыИМагазиныРасширеннаяПодсказкаОбработкаНавигационнойСсылки(Элемент,
		НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка);

КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция АдресВыбранныхЗначений(Знач ПараметрыФормы)

	ДанныеФормыКоллекция = Объект[ПараметрыФормы.ТаблицаЗаполнения];
	ТаблицаЗначений = ДанныеФормыКоллекция.Выгрузить( , ПараметрыФормы.КолонкаЗаполнения);
	Результат = ПоместитьВоВременноеХранилище(ТаблицаЗначений, УникальныйИдентификатор);
	Возврат Результат;

КонецФункции

&НаСервере
Процедура ОбновитьДанныеОбъекта(ВыбранноеЗначение)

	ОбменДаннымиУНФ.ОбновитьДанныеОбъекта(Объект, ВыбранноеЗначение);
	ОбменДаннымиУНФ.ОбновитьЗаголовкиКомандФормы(Объект, Элементы);

КонецПроцедуры

#КонецОбласти