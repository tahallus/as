#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

	
#Область СлужебныеПроцедурыИФункции

// Процедура заполняет справочник сегментов по умолчанию
//
Процедура ЗаполнитьПоставляемыеИсточникиПривлеченияПокупателей() Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	ИсточникиПривлеченияПокупателей.Ссылка КАК Источник
		|ИЗ
		|	Справочник.ИсточникиПривлеченияПокупателей КАК ИсточникиПривлеченияПокупателей";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Если Не РезультатЗапроса.Пустой() Тогда
		Возврат;
	КонецЕсли;
	
	// 1. Сайт
	Источник = Справочники.ИсточникиПривлеченияПокупателей.СоздатьЭлемент();
	Источник.УстановитьНовыйКод();
	Источник.Наименование = НСтр("ru='Сайт'");
	
	ОбновлениеИнформационнойБазы.ЗаписатьДанные(Источник);
	
	// 2. E-mail
	Источник = Справочники.ИсточникиПривлеченияПокупателей.СоздатьЭлемент();
	Источник.УстановитьНовыйКод();
	Источник.Наименование = НСтр("ru='E-mail'");
	
	ОбновлениеИнформационнойБазы.ЗаписатьДанные(Источник);
	
	// 3. Звонок
	Источник = Справочники.ИсточникиПривлеченияПокупателей.СоздатьЭлемент();
	Источник.УстановитьНовыйКод();
	Источник.Наименование = НСтр("ru='Звонок'");
	
	ОбновлениеИнформационнойБазы.ЗаписатьДанные(Источник);
	
	// 4. Выставка
	Источник = Справочники.ИсточникиПривлеченияПокупателей.СоздатьЭлемент();
	Источник.УстановитьНовыйКод();
	Источник.Наименование = НСтр("ru='Выставка'");
	
	ОбновлениеИнформационнойБазы.ЗаписатьДанные(Источник);
	
	// 5. Рекламная кампания
	Источник = Справочники.ИсточникиПривлеченияПокупателей.СоздатьЭлемент();
	Источник.УстановитьНовыйКод();
	Источник.Наименование = НСтр("ru='Рекламная кампания'");
	
	ОбновлениеИнформационнойБазы.ЗаписатьДанные(Источник);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытий

Процедура ОбработкаПолученияДанныхВыбора(ДанныеВыбора, Параметры, СтандартнаяОбработка)
	
	Если Параметры.ВыборГруппИЭлементов <> ИспользованиеГруппИЭлементов.Группы Тогда
		
		Если Не Параметры.Отбор.Свойство("Недействителен") Тогда
			Параметры.Отбор.Вставить("Недействителен", Ложь);
		КонецЕсли;
		
	Иначе
		
		Для Каждого КлючИЗначение Из Параметры.Отбор Цикл
			НайденныйРеквизит = Метаданные.Справочники.ИсточникиПривлеченияПокупателей.Реквизиты.Найти(КлючИЗначение.Ключ);
			Если НайденныйРеквизит = Неопределено Тогда
				Продолжить;
			КонецЕсли;
			Если НайденныйРеквизит.Использование = Метаданные.СвойстваОбъектов.ИспользованиеРеквизита.ДляЭлемента Тогда
				Параметры.Отбор.Удалить(КлючИЗначение.Ключ);
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли