
#Область ОписаниеПеременных

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	Если Параметры.Отбор.Свойство("ПериодРасшифровки") Тогда
		УстановитьПараметрНаСервере("НачалоПериода", Параметры.Отбор.ПериодРасшифровки.ДатаНачала);
		УстановитьПараметрНаСервере("КонецПериода", Параметры.Отбор.ПериодРасшифровки.ДатаОкончания);
	КонецЕсли;
	
	Если Параметры.Свойство("Организация") Тогда
		Организация = Параметры.Организация;
		УстановитьПараметрНаСервере("Организация", Организация);
	ИначеЕсли Параметры.Отбор.Свойство("Организация") Тогда
		Организация = Параметры.Отбор.Организация;
		УстановитьПараметрНаСервере("Организация", Организация);
	Иначе
		ВызватьИсключение НСтр("ru = 'Открытие отчета предусмотрено только из документа ""Закрытие месяца"".'");
	КонецЕсли;
	
	Если Параметры.Свойство("ДатаФормирования") Тогда
		ДатаФормирования = Параметры["ДатаФормирования"];
		УстановитьПараметрНаСервере("ДатаФормирования", ДатаФормирования);
	КонецЕсли;
	
	Элементы.ОсновнаяКоманднаяПанель.Видимость = Ложь;
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	СкомпоноватьРезультат();
	
КонецПроцедуры

#КонецОбласти 

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УстановитьПараметрНаСервере(ИмяПараметра, ЗначениеПараметра)
	
	НастройкаКомпоновки = Отчет.КомпоновщикНастроек.Настройки;
	НайденнаяНастройка= НастройкаКомпоновки.ПараметрыДанных.Элементы.Найти(ИмяПараметра);
	
	Если НЕ НайденнаяНастройка = Неопределено Тогда
		
		ЭлементПользовательскойНастройки = Отчет.КомпоновщикНастроек.ПользовательскиеНастройки.Элементы.Найти(
			НайденнаяНастройка.ИдентификаторПользовательскойНастройки
		);
		ЭлементПользовательскойНастройки.Использование = Истина;
		ЭлементПользовательскойНастройки.Значение = ЗначениеПараметра;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
 




